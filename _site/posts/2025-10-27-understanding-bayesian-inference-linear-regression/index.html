<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stefan Schreiber">
<meta name="dcterms.date" content="2025-10-27">

<title>Understanding Bayesian Inference: Linear Regression – Quantitative Environmental Services</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-e83117e711fad372bcb8c8022997a9a8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Understanding Bayesian Inference: Linear Regression – Quantitative Environmental Services">
<meta property="og:description" content="From Seed Germination to Tree Improvement to Business Decisions">
<meta property="og:image" content="https://www.envirostats.ca/posts/2025-10-27-understanding-bayesian-inference-linear-regression/francis_galton.png">
<meta property="og:site_name" content="Quantitative Environmental Services">
<meta property="og:image:height" content="1536">
<meta property="og:image:width" content="1024">
<meta property="og:image:alt" content="Francis Galton">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/favicon.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Quantitative Environmental Services</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../mission.html"> 
<span class="menu-text">Our Mission</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../services.html"> 
<span class="menu-text">Our Services</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Who we are</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Insights</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Understanding Bayesian Inference: Linear Regression</h1>
            <p class="subtitle lead">From Seed Germination to Tree Improvement to Business Decisions</p>
                                <div class="quarto-categories">
                <div class="quarto-category">bayesian</div>
                <div class="quarto-category">inference</div>
                <div class="quarto-category">regression</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Stefan Schreiber </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 27, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#a-brief-historical-note-francis-galton-and-the-origins-of-regression" id="toc-a-brief-historical-note-francis-galton-and-the-origins-of-regression" class="nav-link" data-scroll-target="#a-brief-historical-note-francis-galton-and-the-origins-of-regression">A Brief Historical Note: Francis Galton and the Origins of Regression</a></li>
  <li><a href="#example-1-a-simple-start---predicting-tree-height-from-diameter" id="toc-example-1-a-simple-start---predicting-tree-height-from-diameter" class="nav-link" data-scroll-target="#example-1-a-simple-start---predicting-tree-height-from-diameter">Example 1: A Simple Start - Predicting Tree Height from Diameter</a>
  <ul class="collapse">
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The Data</a></li>
  <li><a href="#the-model" id="toc-the-model" class="nav-link" data-scroll-target="#the-model">The Model</a></li>
  <li><a href="#why-prior-choice-matters-revisiting-a-key-lesson" id="toc-why-prior-choice-matters-revisiting-a-key-lesson" class="nav-link" data-scroll-target="#why-prior-choice-matters-revisiting-a-key-lesson">Why Prior Choice Matters: Revisiting a Key Lesson</a></li>
  <li><a href="#what-happens-with-flat-priors" id="toc-what-happens-with-flat-priors" class="nav-link" data-scroll-target="#what-happens-with-flat-priors">What Happens with Flat Priors?</a>
  <ul class="collapse">
  <li><a href="#weakly-informative-priors" id="toc-weakly-informative-priors" class="nav-link" data-scroll-target="#weakly-informative-priors">Weakly Informative Priors</a></li>
  </ul></li>
  <li><a href="#visualizing-our-priors-as-distributions" id="toc-visualizing-our-priors-as-distributions" class="nav-link" data-scroll-target="#visualizing-our-priors-as-distributions">Visualizing Our Priors as Distributions</a></li>
  <li><a href="#fitting-the-model" id="toc-fitting-the-model" class="nav-link" data-scroll-target="#fitting-the-model">Fitting the Model</a></li>
  <li><a href="#making-direct-probability-statements" id="toc-making-direct-probability-statements" class="nav-link" data-scroll-target="#making-direct-probability-statements">Making Direct Probability Statements</a></li>
  <li><a href="#visualizing-the-posterior" id="toc-visualizing-the-posterior" class="nav-link" data-scroll-target="#visualizing-the-posterior">Visualizing the Posterior</a></li>
  <li><a href="#posterior-predictive-check" id="toc-posterior-predictive-check" class="nav-link" data-scroll-target="#posterior-predictive-check">Posterior Predictive Check</a></li>
  <li><a href="#what-weve-learned-from-this-example" id="toc-what-weve-learned-from-this-example" class="nav-link" data-scroll-target="#what-weve-learned-from-this-example">What We’ve Learned from This Example</a></li>
  </ul></li>
  <li><a href="#example-2-predicting-volume-and-tree-improvement-economics" id="toc-example-2-predicting-volume-and-tree-improvement-economics" class="nav-link" data-scroll-target="#example-2-predicting-volume-and-tree-improvement-economics">Example 2: Predicting Volume and Tree Improvement Economics</a>
  <ul class="collapse">
  <li><a href="#part-a-volume-prediction-model" id="toc-part-a-volume-prediction-model" class="nav-link" data-scroll-target="#part-a-volume-prediction-model">Part A: Volume Prediction Model</a>
  <ul class="collapse">
  <li><a href="#the-model-1" id="toc-the-model-1" class="nav-link" data-scroll-target="#the-model-1">The Model</a></li>
  <li><a href="#fitting-the-volume-model" id="toc-fitting-the-volume-model" class="nav-link" data-scroll-target="#fitting-the-volume-model">Fitting the Volume Model</a></li>
  <li><a href="#making-probability-statements-about-effects" id="toc-making-probability-statements-about-effects" class="nav-link" data-scroll-target="#making-probability-statements-about-effects">Making Probability Statements About Effects</a></li>
  </ul></li>
  <li><a href="#part-b-tree-improvement-economics" id="toc-part-b-tree-improvement-economics" class="nav-link" data-scroll-target="#part-b-tree-improvement-economics">Part B: Tree Improvement Economics</a>
  <ul class="collapse">
  <li><a href="#the-scenario" id="toc-the-scenario" class="nav-link" data-scroll-target="#the-scenario">The Scenario</a></li>
  <li><a href="#simulating-realistic-data" id="toc-simulating-realistic-data" class="nav-link" data-scroll-target="#simulating-realistic-data">Simulating Realistic Data</a></li>
  <li><a href="#bayesian-models-for-each-seedlot" id="toc-bayesian-models-for-each-seedlot" class="nav-link" data-scroll-target="#bayesian-models-for-each-seedlot">Bayesian Models for Each Seedlot</a></li>
  <li><a href="#answering-economic-questions-with-probability" id="toc-answering-economic-questions-with-probability" class="nav-link" data-scroll-target="#answering-economic-questions-with-probability">Answering Economic Questions with Probability</a></li>
  <li><a href="#generating-predictions-with-full-uncertainty" id="toc-generating-predictions-with-full-uncertainty" class="nav-link" data-scroll-target="#generating-predictions-with-full-uncertainty">Generating Predictions with Full Uncertainty</a></li>
  <li><a href="#visualizing-the-economic-decision" id="toc-visualizing-the-economic-decision" class="nav-link" data-scroll-target="#visualizing-the-economic-decision">Visualizing the Economic Decision</a></li>
  <li><a href="#whats-the-minimum-required-gain" id="toc-whats-the-minimum-required-gain" class="nav-link" data-scroll-target="#whats-the-minimum-required-gain">What’s the Minimum Required Gain?</a></li>
  <li><a href="#sensitivity-to-profit-margins" id="toc-sensitivity-to-profit-margins" class="nav-link" data-scroll-target="#sensitivity-to-profit-margins">Sensitivity to Profit Margins</a></li>
  </ul></li>
  <li><a href="#real-world-application-the-alberta-tree-improvement-investment-problem" id="toc-real-world-application-the-alberta-tree-improvement-investment-problem" class="nav-link" data-scroll-target="#real-world-application-the-alberta-tree-improvement-investment-problem">Real-World Application: The Alberta Tree Improvement Investment Problem</a></li>
  </ul></li>
  <li><a href="#key-takeaways-from-seed-germination-to-tree-improvement-to-business-decisions" id="toc-key-takeaways-from-seed-germination-to-tree-improvement-to-business-decisions" class="nav-link" data-scroll-target="#key-takeaways-from-seed-germination-to-tree-improvement-to-business-decisions">Key Takeaways: From Seed Germination to Tree Improvement to Business Decisions</a>
  <ul class="collapse">
  <li><a href="#the-journey-weve-taken" id="toc-the-journey-weve-taken" class="nav-link" data-scroll-target="#the-journey-weve-taken">The Journey We’ve Taken</a></li>
  <li><a href="#core-principles-that-carry-forward" id="toc-core-principles-that-carry-forward" class="nav-link" data-scroll-target="#core-principles-that-carry-forward">Core Principles That Carry Forward</a></li>
  <li><a href="#what-changes-and-what-doesnt" id="toc-what-changes-and-what-doesnt" class="nav-link" data-scroll-target="#what-changes-and-what-doesnt">What Changes and What Doesn’t</a></li>
  <li><a href="#practical-wisdom" id="toc-practical-wisdom" class="nav-link" data-scroll-target="#practical-wisdom">Practical Wisdom</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="francis_galton.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>When in doubt, just fit straight lines. ;P</figcaption>
</figure>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In our <a href="https://www.envirostats.ca/posts/2025-10-20-understanding-bayesian-inference-foundations/">previous post</a>, we explored the foundations of Bayesian inference through a simple example: estimating germination rates from seed trials. We learned how to specify priors, update beliefs with data through Bayes’ theorem, and make probabilistic predictions. The key insight was treating parameters as random variables with probability distributions, allowing us to make direct statements like “there’s a 95% probability the germination rate is between 0.42 and 0.75.”</p>
<p>That example involved estimating a single parameter – a probability <span class="math inline">\(\theta\)</span>. But most real-world problems involve relationships between variables: How does tree height relate to diameter? How does drug dosage affect blood pressure? How do temperature and rainfall predict crop yield? These questions require regression models with <strong>multiple parameters</strong>: slopes, intercepts, and error terms.</p>
<p>In that first post on seed germination, we worked with a single parameter <span class="math inline">\(\theta\)</span> (the germination rate). The Beta-Binomial model was simple: one probability to estimate, one prior to specify. You might be wondering: does Bayesian inference scale to more complex problems? What happens when we have multiple parameters that interact?</p>
<p>The answer is both simple and profound: <strong>the logic doesn’t change at all</strong>. Whether you have 1 parameter or 100, the Bayesian workflow remains identical. You specify priors for each parameter, observe data, apply Bayes’ theorem, and make predictions. The mathematics gets more complex, but the conceptual framework is exactly the same.</p>
<p>This post demonstrates that claim by extending everything you learned about seed germination to linear regression with multiple predictors. If you understood how to update beliefs about germination rates, you already understand Bayesian regression – we’re just applying the same principles to familiar statistical models.</p>
<p>The beautiful truth about Bayesian inference is that moving from one parameter to many changes nothing fundamental. The logic remains identical:</p>
<ol type="1">
<li><strong>Specify priors</strong> for all parameters</li>
<li><strong>Observe data</strong> and compute the likelihood</li>
<li><strong>Apply Bayes’ theorem</strong> to get the posterior distribution</li>
<li><strong>Make predictions</strong> by sampling from the posterior</li>
</ol>
<p>In this post, we’ll apply Bayesian inference to linear regression using real forestry data. We’ll work through two examples:</p>
<ul>
<li><strong>Example 1</strong>: Predicting tree height from diameter – learning why prior choice matters</li>
<li><strong>Example 2</strong>: Evaluating tree improvement programs – making economic decisions with uncertainty</li>
</ul>
<p>By the end, you’ll see that Bayesian regression is simply Bayesian inference applied to familiar statistical models. The principles you learned from seed germination transfer directly – we’re just working with more parameters simultaneously.</p>
</section>
<section id="a-brief-historical-note-francis-galton-and-the-origins-of-regression" class="level1">
<h1>A Brief Historical Note: Francis Galton and the Origins of Regression</h1>
<p>Before diving into our analysis, it’s worth appreciating where linear regression came from. The method we’re about to use has a fascinating origin story rooted in Victorian-era genetics and an obsession with heredity.</p>
<p><strong>Sir Francis Galton</strong> (1822-1911), a polymath and Charles Darwin’s half-cousin, pioneered regression while studying inheritance patterns. In the 1880s, Galton collected data on the heights of parents and their adult children. He discovered something curious: tall parents tended to have tall children (as expected), but those children were, on average, shorter than their parents. Conversely, short parents tended to have children who were taller than them.</p>
<p>Galton called this phenomenon “regression toward mediocrity” – later shortened to simply “regression.” The children’s heights “regressed” toward the population mean. This observation led him to develop the mathematical tools for describing the linear relationship between two variables <span class="citation" data-cites="galton1886regression">(<a href="#ref-galton1886regression" role="doc-biblioref">Galton, 1886</a>)</span>.</p>
<p><strong>The method’s name is now somewhat misleading</strong>: we rarely use “regression” to study this “regression to the mean” phenomenon anymore. Instead, the term stuck as the general name for modeling relationships between variables using straight lines (or curves). What Galton discovered was that children’s heights could be predicted from parental heights using a linear equation – the same kind of equation we’ll use to predict tree heights from diameters.</p>
<p><strong>Karl Pearson</strong> (1857-1936), Galton’s protégé, formalized these ideas into the regression methods we use today, developing the mathematics of correlation and least squares estimation <span class="citation" data-cites="pearson1896mathematical">(<a href="#ref-pearson1896mathematical" role="doc-biblioref">Pearson, 1896</a>)</span>. Interestingly, while Galton and Pearson developed their methods in a frequentist framework – focusing on best-fit lines through data – the Bayesian approach we’ll use asks slightly different questions: not just “what line best fits this data?” but “given this data, what can we believe about the relationship?”</p>
<p>The tree data we’ll analyze follows Galton’s original spirit: we’re exploring biological relationships where larger individuals tend to have other larger characteristics, though with considerable variation around the trend.</p>
</section>
<section id="example-1-a-simple-start---predicting-tree-height-from-diameter" class="level1">
<h1>Example 1: A Simple Start - Predicting Tree Height from Diameter</h1>
<p>We’ll begin with a straightforward example: predicting tree height from diameter using the classic <code>trees</code> dataset. This single-predictor model will help us understand the Bayesian regression workflow and – crucially – see why prior choice matters.</p>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The Data</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and prepare data</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>scale_factor <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># DBH in units of 10 cm</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to metric and scale for better interpretation</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>trees <span class="ot">&lt;-</span> datasets<span class="sc">::</span>trees <span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh =</span> Girth <span class="sc">*</span> <span class="fl">2.54</span>,                           <span class="co"># inches -&gt; cm</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> Height <span class="sc">*</span> <span class="fl">0.3048</span>,                     <span class="co"># feet -&gt; meters</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">volume =</span> Volume <span class="sc">*</span> <span class="fl">0.0283168</span>,                  <span class="co"># cubic feet -&gt; cubic meters</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh_scaled =</span> (dbh <span class="sc">-</span> <span class="fu">mean</span>(dbh)) <span class="sc">/</span> scale_factor <span class="co"># center and scale by 10 cm</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick look at the relationship</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(trees, <span class="fu">aes</span>(<span class="at">x =</span> dbh, <span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Tree Height vs. Diameter"</span>, </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black Cherry Trees (n = 31)"</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Diameter at Breast Height (cm)"</span>, </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Height (m)"</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The relationship looks roughly linear and positive – we expect taller trees to have larger diameters.</p>
</section>
<section id="the-model" class="level2">
<h2 class="anchored" data-anchor-id="the-model">The Model</h2>
<p>We’ll predict tree height from diameter:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Normal}(\mu_i, \sigma) \\
\mu_i &amp;= \alpha + \beta \cdot x_i \\
\alpha &amp;\sim \text{Normal}(20, 3) \\
\beta &amp;\sim \text{Normal}(1, 1) \\
\sigma &amp;\sim \text{Exponential}(0.5)
\end{aligned}
\]</span></p>
<p><strong>In words</strong>:</p>
<ul>
<li><strong>What we’re predicting</strong>: <span class="math inline">\(y_i\)</span> is the observed height (in meters) for tree <span class="math inline">\(i\)</span></li>
<li><strong>The model structure</strong>: Each tree’s height comes from a Normal distribution with mean <span class="math inline">\(\mu_i\)</span> and standard deviation <span class="math inline">\(\sigma\)</span></li>
<li><strong>The relationship</strong>: Mean height <span class="math inline">\(\mu_i\)</span> depends linearly on diameter through <span class="math inline">\(\alpha + \beta \cdot x_i\)</span>, where <span class="math inline">\(x_i\)</span> is the scaled diameter (DBH) for tree <span class="math inline">\(i\)</span></li>
<li><strong>What the priors represent</strong>: Our uncertainty about the model parameters before seeing the data
<ul>
<li><span class="math inline">\(\text{Normal}(20, 3)\)</span> for intercept (<span class="math inline">\(\alpha\)</span>): expected height at mean DBH is around 20 meters</li>
<li><span class="math inline">\(\text{Normal}(1, 1)\)</span> for slope (<span class="math inline">\(\beta\)</span>): height increases by roughly 1 meter per 10 cm increase in DBH</li>
<li><span class="math inline">\(\text{Exponential}(0.5)\)</span> for residual standard deviation (<span class="math inline">\(\sigma\)</span>): constrains variation to be positive</li>
</ul></li>
<li><strong>Why these priors work</strong>: They encode basic domain knowledge (trees are positive heights, larger diameter → taller) while remaining weak enough that the data can easily override them if reality differs</li>
</ul>
</section>
<section id="why-prior-choice-matters-revisiting-a-key-lesson" class="level2">
<h2 class="anchored" data-anchor-id="why-prior-choice-matters-revisiting-a-key-lesson">Why Prior Choice Matters: Revisiting a Key Lesson</h2>
<p>In our seed germination example, we compared different priors (uniform, weakly informative, and strongly informative) and saw how they updated with data. That example involved a single parameter bounded between 0 and 1, making it relatively straightforward to specify sensible priors.</p>
<p>But regression introduces new challenges: <strong>multiple parameters on different scales that interact</strong>. This is where the “flat priors are objective” misconception becomes especially dangerous.</p>
<p>Recall from the frequentist post that all statistical methods involve choices – which test to use, what <span class="math inline">\(\alpha\)</span>-level, when to stop data collection. The Bayesian framework makes these choices explicit through prior specification. But what happens when we try to be “objective” by using very vague priors in regression?</p>
</section>
<section id="what-happens-with-flat-priors" class="level2">
<h2 class="anchored" data-anchor-id="what-happens-with-flat-priors">What Happens with Flat Priors?</h2>
<p>Let’s use the same philosophy as Beta(1,1) for germination – expressing “complete ignorance” through very vague priors:</p>
<p>Suppose we use very vague priors that express “ignorance”. This seems “objective” – we’re not favoring any particular values. But watch what happens when we use prior predictive checks (the same technique from the seed germination post) to see what kinds of data these priors expect. For this example, we’ll assume these vague priors:</p>
<ul>
<li><span class="math inline">\(\alpha \sim \text{Normal}(0, 100)\)</span></li>
<li><span class="math inline">\(\beta \sim \text{Normal}(0, 10)\)</span></li>
<li><span class="math inline">\(\sigma \sim \text{Exponential}(0.1)\)</span></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20250823</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Very vague priors—often called "flat" or "uninformative"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>alpha_prior_flat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_draws, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">100</span>)  <span class="co"># Intercept: anywhere from -200 to +200 m</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>beta_prior_flat  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_draws, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">10</span>)   <span class="co"># Slope: anywhere from -20 to +20 m per 10 cm</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid for predictions across observed DBH range</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>dbh_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(trees<span class="sc">$</span>dbh), <span class="fu">max</span>(trees<span class="sc">$</span>dbh), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>dbh_grid_scaled <span class="ot">&lt;-</span> (dbh_grid <span class="sc">-</span> <span class="fu">mean</span>(trees<span class="sc">$</span>dbh)) <span class="sc">/</span> scale_factor</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate prior predictive lines</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>prior_pred_flat <span class="ot">&lt;-</span> <span class="fu">map2_dfr</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  alpha_prior_flat, beta_prior_flat,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">tibble</span>(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh =</span> dbh_grid,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> .x <span class="sc">+</span> .y <span class="sc">*</span> dbh_grid_scaled</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">.id =</span> <span class="st">"draw"</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample 100 lines for visualization</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>selected_draws <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(prior_pred_flat<span class="sc">$</span>draw), <span class="dv">100</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>prior_pred_subset <span class="ot">&lt;-</span> prior_pred_flat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(draw <span class="sc">%in%</span> selected_draws)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prior_pred_subset, <span class="fu">aes</span>(<span class="at">x =</span> dbh, <span class="at">y =</span> height, <span class="at">group =</span> draw)) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(trees<span class="sc">$</span>dbh), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">50</span>, <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Prior Predictive Check: Flat Priors"</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"100 randomly drawn regression lines from vague priors"</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Diameter (cm)"</span>, </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Height (m)"</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Problem: Many lines predict negative heights or impossibly tall trees!</span><span class="sc">\n</span><span class="st">Dashed line shows mean DBH where intercept is interpretable."</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Problems with flat priors:</strong></p>
<ul>
<li><strong>Allows negative tree heights</strong> (biologically impossible)</li>
<li><strong>Allows negative slopes</strong> (taller trees have larger diameters)</li>
<li><strong>Allows impossibly tall trees</strong> (100+ meters for black cherry)</li>
<li><strong>Wastes probability mass</strong> on parameter combinations that could never occur</li>
</ul>
<p><strong>Flat priors are not “objective”</strong> – they encode very strong (and wrong) assumptions. They say “a 50-meter tall sapling is just as plausible as a 20-meter mature tree” and “trees that shrink as they grow are reasonable.”</p>
<p><strong>The lesson from seed germination still applies:</strong> priors encode assumptions whether we acknowledge them or not. The difference is that in regression, <strong>flat priors have worse consequences</strong>:</p>
<ul>
<li><strong>Beta(1,1) for germination:</strong> Allows any rate from 0 to 1, which are all biologically possible</li>
<li><strong>Normal(0, 100) for tree height intercept:</strong> Allows negative heights and 100+ meter saplings, which are <strong>impossible</strong></li>
</ul>
<p>The key insight from our series: just as we used prior knowledge (published germination rates, historical supplier data) to inform the seed germination prior, we should use <strong>domain knowledge</strong> (trees don’t have negative height, trees grow up not down) to inform regression priors.</p>
<p><strong>You’re not “cheating” by using informative priors – you’re incorporating knowledge that everyone already has.</strong> The alternative (flat priors) pretends you don’t know basic facts about the world, which is both dishonest and statistically harmful.</p>
<section id="weakly-informative-priors" class="level3">
<h3 class="anchored" data-anchor-id="weakly-informative-priors">Weakly Informative Priors</h3>
<p>Now let’s use priors that encode minimal biological knowledge:</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20250823</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Weakly informative priors based on minimal biological knowledge</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>alpha_prior_inf <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_draws, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)   <span class="co"># Height at mean DBH: around 15-25 m</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>beta_prior_inf <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_draws, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>)     <span class="co"># Slope: around 0-3 m per 10 cm, centered at 1</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate prior predictive lines</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>prior_pred_inf <span class="ot">&lt;-</span> <span class="fu">map2_dfr</span>(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  alpha_prior_inf, beta_prior_inf,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> <span class="fu">tibble</span>(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh =</span> dbh_grid,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> .x <span class="sc">+</span> .y <span class="sc">*</span> dbh_grid_scaled</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">.id =</span> <span class="st">"draw"</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>selected_draws_inf <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(prior_pred_inf<span class="sc">$</span>draw), <span class="dv">100</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>prior_pred_subset_inf <span class="ot">&lt;-</span> prior_pred_inf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(draw <span class="sc">%in%</span> selected_draws_inf)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prior_pred_subset_inf, <span class="fu">aes</span>(<span class="at">x =</span> dbh, <span class="at">y =</span> height, <span class="at">group =</span> draw)) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(trees<span class="sc">$</span>dbh), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Prior Predictive Check: Weakly Informative Priors"</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"100 randomly drawn regression lines from biologically informed priors"</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Diameter (cm)"</span>, </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Height (m)"</span>,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"All predictions are biologically plausible: positive heights (15-30 m), positive slopes.</span><span class="sc">\n</span><span class="st">Dashed line shows mean DBH."</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Much better!</strong> These priors:</p>
<ul>
<li><strong>Keep heights positive and reasonable</strong> (15-30 m range)</li>
<li><strong>Support positive relationships</strong> (taller trees have larger diameters)</li>
<li><strong>Still allow data to substantially update beliefs</strong> (wide enough to not be dogmatic)</li>
<li><strong>Reflect minimal biological constraints</strong> (you don’t need a PhD in forestry)</li>
</ul>
<p>This is the key insight: <strong>You’re not claiming to know the answer ahead of time; you’re just ruling out nonsense.</strong> It’s like saying “I don’t know exactly how tall that building is, but I know it’s not negative height and it’s not 1000 km tall.”</p>
</section>
</section>
<section id="visualizing-our-priors-as-distributions" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-our-priors-as-distributions">Visualizing Our Priors as Distributions</h2>
<p>Let’s also look at the prior distributions themselves:</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate samples from our priors</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>prior_samples <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="fu">rnorm</span>(n_draws, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> <span class="fu">rnorm</span>(n_draws, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">rexp</span>(n_draws, <span class="at">rate =</span> <span class="fl">0.5</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the prior distributions</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior_samples, <span class="fu">aes</span>(<span class="at">x =</span> intercept)) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"#7570b3"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Prior for Intercept"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Normal(20, 3)"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Intercept α (m)"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior_samples, <span class="fu">aes</span>(<span class="at">x =</span> slope)) <span class="sc">+</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"#1b9e77"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Prior for Slope"</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Normal(1, 1)"</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Slope β (m per 10 cm DBH)"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prior_samples, <span class="fu">aes</span>(<span class="at">x =</span> sigma)) <span class="sc">+</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"#d95f02"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Prior for Residual SD"</span>,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Exponential(0.5)"</span>,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sigma σ (m)"</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2 <span class="sc">|</span> p3) <span class="sc">+</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Prior Distributions for Height Model Parameters"</span>,</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"What we believe before seeing the data"</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>What these priors say:</strong></p>
<ul>
<li><strong>Intercept</strong>: Centered at 20 m (typical height for trees with average DBH), allowing variation between roughly 14-26 m</li>
<li><strong>Slope</strong>: Centered at 1 m per 10 cm DBH increase, allowing values between roughly -1 to 3 m</li>
<li><strong>Sigma</strong>: Most mass between 0.5-6 m, weakly favoring smaller residual variation</li>
</ul>
<p>These are <strong>weakly informative</strong> priors – they gently constrain parameters to reasonable scales without being dogmatic.</p>
</section>
<section id="fitting-the-model" class="level2">
<h2 class="anchored" data-anchor-id="fitting-the-model">Fitting the Model</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Bayesian linear regression</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>fit_height <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> dbh_scaled,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> trees,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="dv">20</span>, <span class="dv">3</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_aux =</span> <span class="fu">exponential</span>(<span class="fl">0.5</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Display posterior summary as formatted table</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_height, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Parameter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Posterior Summary Statistics"</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Posterior Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">mcse</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">2.5%</th>
<th style="text-align: right;">97.5%</th>
<th style="text-align: right;">n_eff</th>
<th style="text-align: right;">Rhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">23.136</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">0.313</td>
<td style="text-align: right;">22.518</td>
<td style="text-align: right;">23.754</td>
<td style="text-align: right;">2965</td>
<td style="text-align: right;">1.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dbh_scaled</td>
<td style="text-align: right;">1.225</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">0.382</td>
<td style="text-align: right;">0.442</td>
<td style="text-align: right;">1.965</td>
<td style="text-align: right;">3669</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">1.737</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.235</td>
<td style="text-align: right;">1.359</td>
<td style="text-align: right;">2.252</td>
<td style="text-align: right;">3094</td>
<td style="text-align: right;">1.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">mean_PPD</td>
<td style="text-align: right;">23.133</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.435</td>
<td style="text-align: right;">22.274</td>
<td style="text-align: right;">23.985</td>
<td style="text-align: right;">2849</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log-posterior</td>
<td style="text-align: right;">-65.312</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">1.314</td>
<td style="text-align: right;">-68.777</td>
<td style="text-align: right;">-63.826</td>
<td style="text-align: right;">1514</td>
<td style="text-align: right;">1.001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Parameter Interpretation:</strong></p>
<ul>
<li><strong>mean</strong>: Average value across all posterior samples – the central estimate of the parameter</li>
<li><strong>mcse</strong>: Monte Carlo Standard Error – uncertainty in the mean due to finite sampling (smaller is better)</li>
<li><strong>sd</strong>: Standard deviation of the posterior – measures overall uncertainty about the parameter</li>
<li><strong>2.5%, 97.5%</strong>: Bounds of the 95% credible interval – we’re 95% confident the true value lies between these</li>
<li><strong>n_eff</strong>: Effective sample size – number of independent samples after accounting for autocorrelation</li>
<li><strong>Rhat</strong>: Convergence diagnostic – compares within-chain and between-chain variance</li>
</ul>
<p><strong>What to look for:</strong></p>
<ul>
<li><strong>Rhat ≈ 1.00</strong>: Chains have converged (values &gt; 1.01 suggest problems)</li>
<li><strong>n_eff &gt; 1000</strong>: Enough independent samples for reliable inference<br>
</li>
<li><strong>mcse much smaller than sd</strong>: Monte Carlo error is negligible compared to posterior uncertainty</li>
<li><strong>Credible interval makes sense</strong>: Check that the 2.5%-97.5% range is scientifically plausible</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(fit_height, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"dbh_scaled"</span>, <span class="st">"sigma"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Good trace plots</strong> look like “fuzzy caterpillars” – random noise with no trends, all chains overlapping.</p>
</section>
<section id="making-direct-probability-statements" class="level2">
<h2 class="anchored" data-anchor-id="making-direct-probability-statements">Making Direct Probability Statements</h2>
<p>Now we can ask specific questions about the relationship:</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior samples</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>posterior_height <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_height)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct probability statements</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>prob_slope_positive <span class="ot">&lt;-</span> <span class="fu">mean</span>(posterior_height<span class="sc">$</span>dbh_scaled <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>prob_slope_gt_1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(posterior_height<span class="sc">$</span>dbh_scaled <span class="sc">&gt;</span> <span class="fl">1.0</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>prob_slope_gt_1<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">mean</span>(posterior_height<span class="sc">$</span>dbh_scaled <span class="sc">&gt;</span> <span class="fl">1.5</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Credible interval</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>slope_ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(posterior_height<span class="sc">$</span>dbh_scaled, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Question =</span> <span class="fu">c</span>(</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Is the slope positive?"</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Is the slope greater than 1.0 m per 10 cm?"</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Is the slope greater than 1.5 m per 10 cm?"</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"95% Credible Interval"</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Answer =</span> <span class="fu">c</span>(</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"P(β &gt; 0) = %.3f"</span>, prob_slope_positive),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"P(β &gt; 1.0) = %.3f"</span>, prob_slope_gt_1),</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"P(β &gt; 1.5) = %.3f"</span>, prob_slope_gt_1<span class="fl">.5</span>),</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"[%.2f, %.2f] m per 10 cm"</span>, slope_ci[<span class="dv">1</span>], slope_ci[<span class="dv">2</span>])</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Direct probability statements about the height-diameter relationship"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Direct probability statements about the height-diameter relationship</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Question</th>
<th style="text-align: left;">Answer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Is the slope positive?</td>
<td style="text-align: left;">P(β &gt; 0) = 0.999</td>
</tr>
<tr class="even">
<td style="text-align: left;">Is the slope greater than 1.0 m per 10 cm?</td>
<td style="text-align: left;">P(β &gt; 1.0) = 0.738</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Is the slope greater than 1.5 m per 10 cm?</td>
<td style="text-align: left;">P(β &gt; 1.5) = 0.232</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% Credible Interval</td>
<td style="text-align: left;">[0.44, 1.97] m per 10 cm</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
This is what makes Bayesian inference powerful
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can make direct probability statements about parameters. Based on these results, we can say: “There is a 73.8% probability that height increases more than 1 meter for every 10 cm increase in diameter.”</p>
<p>These are the statements researchers and decision – makers actually want—direct quantification of uncertainty about the parameter itself.</p>
</div>
</div>
</section>
<section id="visualizing-the-posterior" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-the-posterior">Visualizing the Posterior</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbh_scaled =</span> <span class="fu">seq</span>(<span class="fu">min</span>(trees<span class="sc">$</span>dbh_scaled), <span class="fu">max</span>(trees<span class="sc">$</span>dbh_scaled), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample 100 posterior draws for visualization</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>sample_draws <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(posterior_height), <span class="at">size =</span> <span class="dv">100</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>fitted_draws_height <span class="ot">&lt;-</span> <span class="fu">crossing</span>(</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  newdata,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">.draw =</span> sample_draws</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu =</span> posterior_height<span class="sc">$</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>[.draw] <span class="sc">+</span> posterior_height<span class="sc">$</span>dbh_scaled[.draw] <span class="sc">*</span> dbh_scaled,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh =</span> dbh_scaled <span class="sc">*</span> scale_factor <span class="sc">+</span> <span class="fu">mean</span>(trees<span class="sc">$</span>dbh)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Posterior mean regression lines (blue lines)</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> fitted_draws_height,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> dbh, <span class="at">y =</span> mu, <span class="at">group =</span> .draw),</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span>  </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Observed data</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> trees,</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(dbh, height),</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Posterior: Regression Lines Show Our Updated Beliefs"</span>,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Each blue line is one plausible relationship given the data"</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Diameter at Breast Height (cm)"</span>,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Height (m)"</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"100 posterior draws | All lines have positive slopes -- our data confirmed trees grow up!"</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key insight</strong>: Every line has a positive slope because the data overwhelmingly support a positive relationship. The variation in lines represents our remaining uncertainty about the exact slope and intercept.</p>
</section>
<section id="posterior-predictive-check" class="level2">
<h2 class="anchored" data-anchor-id="posterior-predictive-check">Posterior Predictive Check</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit_height, <span class="at">ndraws =</span> <span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Posterior Predictive Check: Does Our Model Make Sense?"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Comparing real data to simulated data from the model"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Height (m)"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Dark line = observed data | Light lines = 100 simulated datasets from posterior"</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The observed data (dark line) falls well within the range of simulated datasets – our model captures the essential features of tree heights.</p>
</section>
<section id="what-weve-learned-from-this-example" class="level2">
<h2 class="anchored" data-anchor-id="what-weve-learned-from-this-example">What We’ve Learned from This Example</h2>
<p>This simple example demonstrated several key principles:</p>
<ol type="1">
<li><strong>Prior predictive checks reveal problems</strong>: Flat priors allow nonsense predictions</li>
<li><strong>Weakly informative priors encode domain knowledge</strong>: We ruled out negative heights without being overly restrictive</li>
<li><strong>Direct probability statements</strong>: We can say “<span class="math inline">\(P(slope &gt; 1) = 0.85\)</span>” directly</li>
<li><strong>Full uncertainty visualization</strong>: Posterior draws show all plausible relationships</li>
<li><strong>Model checking</strong>: Posterior predictive checks validate our model assumptions</li>
</ol>
<p>Now let’s apply these same principles to a more complex problem: predicting timber volume with multiple predictors and making economic decisions under uncertainty.</p>
</section>
</section>
<section id="example-2-predicting-volume-and-tree-improvement-economics" class="level1">
<h1>Example 2: Predicting Volume and Tree Improvement Economics</h1>
<p>In this example, we’ll tackle two related questions:</p>
<ol type="1">
<li>How do DBH and height together predict timber volume?</li>
<li>Should a forestry company invest in genetically improved seedlings?</li>
</ol>
<p>This demonstrates Bayesian regression at its best: quantifying uncertainty for real business decisions.</p>
<section id="part-a-volume-prediction-model" class="level2">
<h2 class="anchored" data-anchor-id="part-a-volume-prediction-model">Part A: Volume Prediction Model</h2>
<p>First, let’s build a multiple regression model predicting volume from both DBH and height.</p>
<section id="the-model-1" class="level3">
<h3 class="anchored" data-anchor-id="the-model-1">The Model</h3>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Normal}(\mu_i, \sigma) \\
\mu_i &amp;= \alpha + \beta_1 \cdot \text{dbh}_i + \beta_2 \cdot \text{height}_i \\
\alpha &amp;\sim \text{Normal}(0, 1) \\
\beta_1 &amp;\sim \text{Normal}(0, 1) \\
\beta_2 &amp;\sim \text{Normal}(0, 1) \\
\sigma &amp;\sim \text{Exponential}(1)
\end{aligned}
\]</span></p>
<p><strong>In words</strong>:</p>
<ul>
<li><strong>What we’re predicting</strong>: <span class="math inline">\(y_i\)</span> is the observed volume (in cubic meters) for tree <span class="math inline">\(i\)</span></li>
<li><strong>The model structure</strong>: Each tree’s volume comes from a Normal distribution with mean <span class="math inline">\(\mu_i\)</span> and standard deviation <span class="math inline">\(\sigma\)</span></li>
<li><strong>The relationship</strong>: Mean volume <span class="math inline">\(\mu_i\)</span> depends linearly on both diameter and height through <span class="math inline">\(\alpha + \beta_1 \cdot \text{dbh}_i + \beta_2 \cdot \text{height}_i\)</span></li>
<li><strong>What the priors represent</strong>: Our uncertainty in the model parameters before seeing the data
<ul>
<li><span class="math inline">\(\text{Normal}(0, 1)\)</span> for intercept (<span class="math inline">\(\alpha\)</span>) and slopes (<span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>)</li>
<li><span class="math inline">\(\text{Exponential}(1)\)</span> for residual standard deviation (<span class="math inline">\(\sigma\)</span>)</li>
</ul></li>
<li><strong>Why these priors work</strong>: Since predictors are scaled (standardized to mean 0, SD 1), these priors:
<ul>
<li>Encode weak prior information (expect modest-sized effects)</li>
<li>Allow the data to dominate the posterior</li>
<li>Prevent extreme parameter values that would produce nonsensical predictions</li>
</ul></li>
</ul>
</section>
<section id="fitting-the-volume-model" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-volume-model">Fitting the Volume Model</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale predictors for prior specification</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>trees <span class="ot">&lt;-</span> trees <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">height_scaled =</span> (height <span class="sc">-</span> <span class="fu">mean</span>(height)) <span class="sc">/</span> <span class="fu">sd</span>(height),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh_scaled_vol =</span> (dbh <span class="sc">-</span> <span class="fu">mean</span>(dbh)) <span class="sc">/</span> <span class="fu">sd</span>(dbh)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Bayesian multiple regression</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>fit_volume <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  volume <span class="sc">~</span> dbh_scaled_vol <span class="sc">+</span> height_scaled,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> trees,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_aux =</span> <span class="fu">exponential</span>(<span class="dv">1</span>),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">456</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display posterior summary as formatted table</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_volume, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Parameter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Posterior Summary Statistics Volume Model"</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Posterior Summary Statistics Volume Model</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">mcse</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">2.5%</th>
<th style="text-align: right;">97.5%</th>
<th style="text-align: right;">n_eff</th>
<th style="text-align: right;">Rhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.854</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.813</td>
<td style="text-align: right;">0.894</td>
<td style="text-align: right;">3955</td>
<td style="text-align: right;">1.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">dbh_scaled_vol</td>
<td style="text-align: right;">0.418</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.369</td>
<td style="text-align: right;">0.467</td>
<td style="text-align: right;">2705</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">height_scaled</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.110</td>
<td style="text-align: right;">2537</td>
<td style="text-align: right;">1.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">0.115</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">3020</td>
<td style="text-align: right;">1.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean_PPD</td>
<td style="text-align: right;">0.854</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">0.910</td>
<td style="text-align: right;">4149</td>
<td style="text-align: right;">1.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">log-posterior</td>
<td style="text-align: right;">18.360</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">1.444</td>
<td style="text-align: right;">14.833</td>
<td style="text-align: right;">20.197</td>
<td style="text-align: right;">1659</td>
<td style="text-align: right;">1.001</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="making-probability-statements-about-effects" class="level3">
<h3 class="anchored" data-anchor-id="making-probability-statements-about-effects">Making Probability Statements About Effects</h3>
<p><strong>Key question: How certain are we that height and diameter increase volume?</strong></p>
<p>Because we’ve scaled both predictors (standardized to mean 0, standard deviation 1), the coefficients β<sub>height</sub> and β<sub>DBH</sub> represent the change in volume for a <strong>1 standard deviation change</strong> in each predictor. For this dataset, 1 SD of height ≈ 2 meters and 1 SD of DBH ≈ 4 cm. This scaling allows us to directly compare effect sizes: larger coefficient = stronger effect per SD change.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior samples</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>posterior_volume <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_volume)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Direct probability statements about effects</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>height_prob_positive <span class="ot">&lt;-</span> <span class="fu">mean</span>(posterior_volume<span class="sc">$</span>height_scaled <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>height_prob_gt_005 <span class="ot">&lt;-</span> <span class="fu">mean</span>(posterior_volume<span class="sc">$</span>height_scaled <span class="sc">&gt;</span> <span class="fl">0.05</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>dbh_prob_positive <span class="ot">&lt;-</span> <span class="fu">mean</span>(posterior_volume<span class="sc">$</span>dbh_scaled_vol <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>prob_dbh_larger <span class="ot">&lt;-</span> <span class="fu">mean</span>(posterior_volume<span class="sc">$</span>dbh_scaled_vol <span class="sc">&gt;</span> posterior_volume<span class="sc">$</span>height_scaled)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(posterior_volume)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(fit_volume)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Question =</span> <span class="fu">c</span>(</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Does height increase volume?"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Is height effect &gt; 0.05?"</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Does DBH increase volume?"</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Is DBH effect larger than height effect?"</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Answer =</span> <span class="fu">c</span>(</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"P(β&lt;sub&gt;height&lt;/sub&gt; &gt; 0) = %.3f"</span>, height_prob_positive),</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"P(β&lt;sub&gt;height&lt;/sub&gt; &gt; 0.05) = %.3f"</span>, height_prob_gt_005),</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"P(β&lt;sub&gt;DBH&lt;/sub&gt; &gt; 0) = %.3f"</span>, dbh_prob_positive),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"P(β&lt;sub&gt;DBH&lt;/sub&gt; &gt; β&lt;sub&gt;height&lt;/sub&gt;) = %.3f"</span>, prob_dbh_larger)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Direct probability statements about volume predictors"</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">escape =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Direct probability statements about volume predictors</caption>
<colgroup>
<col style="width: 46%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Question</th>
<th style="text-align: left;">Answer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Does height increase volume?</td>
<td style="text-align: left;">P(β<sub>height</sub> &gt; 0) = 0.992</td>
</tr>
<tr class="even">
<td style="text-align: left;">Is height effect &gt; 0.05?</td>
<td style="text-align: left;">P(β<sub>height</sub> &gt; 0.05) = 0.674</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Does DBH increase volume?</td>
<td style="text-align: left;">P(β<sub>DBH</sub> &gt; 0) = 1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Is DBH effect larger than height effect?</td>
<td style="text-align: left;">P(β<sub>DBH</sub> &gt; β<sub>height</sub>) = 1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can say with near certainty (<span class="math inline">\(P &gt; 0.999\)</span>) that both DBH and height increase timber volume. DBH has the stronger effect per standard deviation change, which makes biological sense – volume depends on cross-sectional area (proportional to DBH²) and height.</p>
<p><strong>Note on notation</strong>: <span class="math inline">\(P(\beta_{\text{height}} &gt; 0)\)</span> means “the probability that the height coefficient is positive.” In Bayesian inference, we can make these direct probability statements because we treat parameters as random variables with probability distributions.</p>
</div>
</div>
</section>
</section>
<section id="part-b-tree-improvement-economics" class="level2">
<h2 class="anchored" data-anchor-id="part-b-tree-improvement-economics">Part B: Tree Improvement Economics</h2>
<p>Now we use this understanding to evaluate a business decision: <strong>Should we invest in genetically improved seedlings?</strong></p>
<section id="the-scenario" class="level3">
<h3 class="anchored" data-anchor-id="the-scenario">The Scenario</h3>
<p>A forestry company is considering switching from wild white spruce seed ($0.50 per seedling) to improved seed from a breeding program ($2.50 per seedling). The breeding program claims 15-20% volume gains.</p>
<p><strong>Economic question</strong>: If we plant 1 million seedlings, will the additional volume justify the $2 million extra investment?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Simplified Economic Model
</div>
</div>
<div class="callout-body-container callout-body">
<p>For pedagogical clarity, this example uses a simplified economic model where we assume <strong>each additional m³ of timber generates $50 in profit</strong>. This is a hypothetical number chosen to illustrate the Bayesian decision-making workflow.</p>
<p>In reality, forest economics involves complex factors including:</p>
<ul>
<li>Stumpage fees paid to government</li>
<li>Variable harvest and processing costs</li>
<li>Market price fluctuations</li>
<li>Discount rates over long rotations (60-80 years)</li>
<li>Regulatory constraints on harvest levels</li>
</ul>
<p>See the <strong>Alberta Forest Management</strong> box below for a realistic example of how these factors interact in practice. The key point is that the <strong>Bayesian workflow remains identical</strong> regardless of model complexity—we simply add more distributions and propagate more uncertainty.</p>
</div>
</div>
</section>
<section id="simulating-realistic-data" class="level3">
<h3 class="anchored" data-anchor-id="simulating-realistic-data">Simulating Realistic Data</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample size</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span>  <span class="co"># Trees measured per seedlot</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate wild seedlot (unimproved)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>wild_trees <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">seedlot =</span> <span class="st">"Wild"</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="dv">25</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbh =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">18</span>, <span class="at">sd =</span> <span class="fl">3.5</span>),  <span class="co"># cm at 25 years</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">14</span>, <span class="at">sd =</span> <span class="fl">2.2</span>)  <span class="co"># meters</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Volume relationship with biological realism</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_volume =</span> <span class="sc">-</span><span class="fl">9.5</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(dbh) <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> <span class="fu">log</span>(height) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.15</span>),</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">volume =</span> <span class="fu">exp</span>(log_volume)   <span class="co"># cubic meters (m³)</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate improved seedlot (genetically superior)</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>improved_trees <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">seedlot =</span> <span class="st">"Improved"</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="dv">25</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbh =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">19.5</span>, <span class="at">sd =</span> <span class="fl">3.0</span>),  <span class="co"># Larger and more uniform</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">15.2</span>, <span class="at">sd =</span> <span class="fl">1.9</span>)  <span class="co"># Taller and more uniform</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_volume =</span> <span class="sc">-</span><span class="fl">9.5</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(dbh) <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> <span class="fu">log</span>(height) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.12</span>),</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">volume =</span> <span class="fu">exp</span>(log_volume)  <span class="co"># cubic meters (m³)</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine datasets</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>tree_comparison <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(wild_trees, improved_trees)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the comparison</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tree_comparison, <span class="fu">aes</span>(<span class="at">x =</span> volume, <span class="at">fill =</span> seedlot)) <span class="sc">+</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Wild"</span> <span class="ot">=</span> <span class="st">"#d95f02"</span>, <span class="st">"Improved"</span> <span class="ot">=</span> <span class="st">"#1b9e77"</span>)) <span class="sc">+</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Volume Distribution by Seedlot Type"</span>,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Volume (m³)"</span>,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Seedlot"</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tree_comparison, <span class="fu">aes</span>(<span class="at">x =</span> seedlot, <span class="at">y =</span> volume, <span class="at">fill =</span> seedlot)) <span class="sc">+</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Wild"</span> <span class="ot">=</span> <span class="st">"#d95f02"</span>, <span class="st">"Improved"</span> <span class="ot">=</span> <span class="st">"#1b9e77"</span>)) <span class="sc">+</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Volume Comparison"</span>,</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Seedlot Type"</span>,</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Volume (m³)"</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bayesian-models-for-each-seedlot" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-models-for-each-seedlot">Bayesian Models for Each Seedlot</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model for wild seedlot</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fit_wild <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  volume <span class="sc">~</span> dbh <span class="sc">+</span> height,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> wild_trees,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_aux =</span> <span class="fu">exponential</span>(<span class="fl">0.1</span>),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display posterior summary as formatted table</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_wild, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Parameter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Posterior Summary Statistics: Wild Seedlot"</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Posterior Summary Statistics: Wild Seedlot</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">mcse</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">2.5%</th>
<th style="text-align: right;">97.5%</th>
<th style="text-align: right;">n_eff</th>
<th style="text-align: right;">Rhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.704</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">-0.790</td>
<td style="text-align: right;">-0.620</td>
<td style="text-align: right;">7083</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">dbh</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">8355</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">height</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.030</td>
<td style="text-align: right;">7446</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">1980</td>
<td style="text-align: right;">1.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean_PPD</td>
<td style="text-align: right;">0.350</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">0.365</td>
<td style="text-align: right;">2962</td>
<td style="text-align: right;">1.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">log-posterior</td>
<td style="text-align: right;">185.494</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">1.452</td>
<td style="text-align: right;">181.873</td>
<td style="text-align: right;">187.323</td>
<td style="text-align: right;">2119</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model for improved seedlot</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fit_improved <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  volume <span class="sc">~</span> dbh <span class="sc">+</span> height,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> improved_trees,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior_aux =</span> <span class="fu">exponential</span>(<span class="fl">0.1</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">456</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display posterior summary as formatted table</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_improved, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Parameter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Posterior Summary Statistics: Improved Seedlot"</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Posterior Summary Statistics: Improved Seedlot</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">mcse</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">2.5%</th>
<th style="text-align: right;">97.5%</th>
<th style="text-align: right;">n_eff</th>
<th style="text-align: right;">Rhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-1.031</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">-1.132</td>
<td style="text-align: right;">-0.932</td>
<td style="text-align: right;">7998</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">dbh</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">9292</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">height</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.029</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">7530</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.060</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">2132</td>
<td style="text-align: right;">1.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean_PPD</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.441</td>
<td style="text-align: right;">0.472</td>
<td style="text-align: right;">3698</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">log-posterior</td>
<td style="text-align: right;">180.875</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">1.423</td>
<td style="text-align: right;">177.265</td>
<td style="text-align: right;">182.653</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">1.001</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="answering-economic-questions-with-probability" class="level3">
<h3 class="anchored" data-anchor-id="answering-economic-questions-with-probability">Answering Economic Questions with Probability</h3>
<p><strong>Question 1: What’s the expected volume gain?</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To properly assess genetic improvement, we compare predictions for </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># TYPICAL trees from each seedlot (using their respective mean sizes)</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This captures both effects: (1) improved seedlings grow bigger, and </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) improved seedlings may have better stem form</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Typical wild seedlot tree</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>typical_wild <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbh =</span> <span class="fu">mean</span>(wild_trees<span class="sc">$</span>dbh),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">mean</span>(wild_trees<span class="sc">$</span>height)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Typical improved seedlot tree  </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>typical_improved <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbh =</span> <span class="fu">mean</span>(improved_trees<span class="sc">$</span>dbh),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">mean</span>(improved_trees<span class="sc">$</span>height)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Get posterior predictions - each model predicts for its own typical tree</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>pred_wild <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit_wild, <span class="at">newdata =</span> typical_wild)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>pred_improved <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit_improved, <span class="at">newdata =</span> typical_improved)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate volume difference</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>volume_gain <span class="ot">&lt;-</span> pred_improved <span class="sc">-</span> pred_wild</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>gain_percent <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> volume_gain <span class="sc">/</span> pred_wild</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mean volume gain"</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Median volume gain"</span>,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"95% Credible Interval"</span>,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mean percent gain"</span>,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Median percent gain"</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f m³"</span>, <span class="fu">mean</span>(volume_gain)),</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f m³"</span>, <span class="fu">median</span>(volume_gain)),</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"[%.3f, %.3f] m³"</span>, <span class="fu">quantile</span>(volume_gain, <span class="fl">0.025</span>), <span class="fu">quantile</span>(volume_gain, <span class="fl">0.975</span>)),</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, <span class="fu">mean</span>(gain_percent)),</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, <span class="fu">median</span>(gain_percent))</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Expected volume gain from tree improvement"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Expected volume gain from tree improvement</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mean volume gain</td>
<td style="text-align: left;">0.105 m³</td>
</tr>
<tr class="even">
<td style="text-align: left;">Median volume gain</td>
<td style="text-align: left;">0.104 m³</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% Credible Interval</td>
<td style="text-align: left;">[-0.082, 0.291] m³</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean percent gain</td>
<td style="text-align: left;">35.1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Median percent gain</td>
<td style="text-align: left;">30.1%</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding this comparison
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’re comparing <strong>typical trees from each seedlot</strong> (using their respective mean sizes). This captures the <strong>total genetic improvement effect</strong>, which includes:</p>
<ol type="1">
<li><strong>Size advantage</strong>: Improved trees grow larger (bigger DBH, taller)</li>
<li><strong>Potential form advantage</strong>: If improved trees have better stem form, taper, or wood density, this would be captured by different model coefficients (though our simulation keeps this simple)</li>
</ol>
<p>In reality, tree breeding programs aim to improve both growth rate (get to merchantable size faster) AND stem quality (more volume per unit size). This comparison captures the combined effect, which is what matters economically: <em>how much more volume will I harvest per tree at rotation age?</em></p>
</div>
</div>
<p><strong>Question 2: What’s the probability of achieving target gains?</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of different gain thresholds</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>prob_gain_positive <span class="ot">&lt;-</span> <span class="fu">mean</span>(volume_gain <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>prob_gain_10pct <span class="ot">&lt;-</span> <span class="fu">mean</span>(gain_percent <span class="sc">&gt;</span> <span class="dv">10</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>prob_gain_15pct <span class="ot">&lt;-</span> <span class="fu">mean</span>(gain_percent <span class="sc">&gt;</span> <span class="dv">15</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>prob_gain_20pct <span class="ot">&lt;-</span> <span class="fu">mean</span>(gain_percent <span class="sc">&gt;</span> <span class="dv">20</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Threshold =</span> <span class="fu">c</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Any positive gain"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gain &gt; 10%"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gain &gt; 15%"</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Gain &gt; 20%"</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probability =</span> <span class="fu">c</span>(</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, prob_gain_positive),</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, prob_gain_10pct),</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, prob_gain_15pct),</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, prob_gain_20pct)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Probability of achieving volume gain targets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Probability of achieving volume gain targets</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Threshold</th>
<th style="text-align: left;">Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Any positive gain</td>
<td style="text-align: left;">0.868</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gain &gt; 10%</td>
<td style="text-align: left;">0.762</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gain &gt; 15%</td>
<td style="text-align: left;">0.697</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gain &gt; 20%</td>
<td style="text-align: left;">0.630</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Business interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>These direct probability statements answer the key question: “What’s the chance our breeding program delivers what it promises?” Decision-makers can use these probabilities to assess risk and make informed investment choices.</p>
</div>
</div>
</section>
<section id="generating-predictions-with-full-uncertainty" class="level3">
<h3 class="anchored" data-anchor-id="generating-predictions-with-full-uncertainty">Generating Predictions with Full Uncertainty</h3>
<p>Before we proceed to the economic analysis, let’s demonstrate one of Bayesian inference’s most powerful features: <strong>generating predictions that include all sources of uncertainty</strong>. This is crucial for realistic decision-making because it prevents us from being overconfident.</p>
<p>When we predict future volumes, there are multiple sources of uncertainty:</p>
<ol type="1">
<li><strong>Parameter uncertainty</strong>: We don’t know the <em>exact</em> regression coefficients (<span class="math inline">\(\alpha, \beta_1, \beta_2, \sigma\)</span>)</li>
<li><strong>Individual tree variation</strong>: Even trees of the same size vary in volume due to genetics, microsite, and measurement error</li>
<li><strong>Model uncertainty</strong>: Our model is a simplification of reality</li>
</ol>
<p>The <strong>posterior predictive distribution</strong> captures all of these simultaneously. Unlike just using the mean parameter estimates (which would give us a single “best guess”), the posterior predictive distribution gives us a full probability distribution of possible outcomes.</p>
<p><strong>Why does this matter for tree improvement decisions?</strong></p>
<p>Imagine you’re planning harvest revenues for the next rotation. If you only use the mean predicted volume gain (say, 15%), you might sign timber contracts based on that number. But what if the actual gain is only 5%? Or 25%? The posterior predictive distribution tells us the <em>range</em> of plausible outcomes, letting us:</p>
<ul>
<li>Calculate probability of meeting minimum revenue targets</li>
<li>Plan for worst-case scenarios</li>
<li>Quantify financial risk accurately</li>
<li>Make conservative estimates for contracts</li>
</ul>
<p>Let’s generate posterior predictions for a future harvest of 1000 trees from each seedlot:</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate a future harvest: 1000 trees from each seedlot</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># These will have the typical size characteristics of each seedlot</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>n_future <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Future wild seedlot trees</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>future_wild <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbh =</span> <span class="fu">rnorm</span>(n_future, <span class="at">mean =</span> <span class="fu">mean</span>(wild_trees<span class="sc">$</span>dbh), <span class="at">sd =</span> <span class="fu">sd</span>(wild_trees<span class="sc">$</span>dbh)),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">rnorm</span>(n_future, <span class="at">mean =</span> <span class="fu">mean</span>(wild_trees<span class="sc">$</span>height), <span class="at">sd =</span> <span class="fu">sd</span>(wild_trees<span class="sc">$</span>height))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Future improved seedlot trees  </span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>future_improved <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbh =</span> <span class="fu">rnorm</span>(n_future, <span class="at">mean =</span> <span class="fu">mean</span>(improved_trees<span class="sc">$</span>dbh), <span class="at">sd =</span> <span class="fu">sd</span>(improved_trees<span class="sc">$</span>dbh)),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">rnorm</span>(n_future, <span class="at">mean =</span> <span class="fu">mean</span>(improved_trees<span class="sc">$</span>height), <span class="at">sd =</span> <span class="fu">sd</span>(improved_trees<span class="sc">$</span>height))</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate posterior predictive distributions</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Each prediction includes parameter uncertainty + residual variation</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>pred_future_wild <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit_wild, <span class="at">newdata =</span> future_wild)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>pred_future_improved <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit_improved, <span class="at">newdata =</span> future_improved)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total volume per 1000 trees for each posterior draw</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Each row of pred_future_* is one posterior draw, columns are individual trees</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>total_volume_wild <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(pred_future_wild)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>total_volume_improved <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(pred_future_improved)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Volume gain per 1000 trees</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>total_gain <span class="ot">&lt;-</span> total_volume_improved <span class="sc">-</span> total_volume_wild</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>gain_per_tree <span class="ot">&lt;-</span> total_gain <span class="sc">/</span> n_future</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mean total volume (Wild)"</span>,</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mean total volume (Improved)"</span>,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mean volume gain per 1000 trees"</span>,</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mean volume gain per tree"</span>,</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"95% CI for gain per tree"</span>,</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P(gain per tree &gt; 0.01 m³)"</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f m³"</span>, <span class="fu">mean</span>(total_volume_wild)),</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f m³"</span>, <span class="fu">mean</span>(total_volume_improved)),</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f m³"</span>, <span class="fu">mean</span>(total_gain)),</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.4f m³"</span>, <span class="fu">mean</span>(gain_per_tree)),</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"[%.4f, %.4f] m³"</span>, </span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>            <span class="fu">quantile</span>(gain_per_tree, <span class="fl">0.025</span>), </span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">quantile</span>(gain_per_tree, <span class="fl">0.975</span>)),</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, <span class="fu">mean</span>(gain_per_tree <span class="sc">&gt;</span> <span class="fl">0.01</span>))</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Posterior predictive distribution: Future harvest of 1000 trees per seedlot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Posterior predictive distribution: Future harvest of 1000 trees per seedlot</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mean total volume (Wild)</td>
<td style="text-align: left;">348.3 m³</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean total volume (Improved)</td>
<td style="text-align: left;">455.9 m³</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mean volume gain per 1000 trees</td>
<td style="text-align: left;">107.6 m³</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean volume gain per tree</td>
<td style="text-align: left;">0.1076 m³</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI for gain per tree</td>
<td style="text-align: left;">[0.0909, 0.1234] m³</td>
</tr>
<tr class="even">
<td style="text-align: left;">P(gain per tree &gt; 0.01 m³)</td>
<td style="text-align: left;">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p><strong>Economic Breakeven Analysis</strong></p>
<p>A critical question for decision-makers is: what volume gain do we need to justify the additional seedling cost? The figure below shows the full distribution of predicted volume gains per tree, with two key reference lines: the expected gain (blue dashed line) and the economic breakeven point (red dashed line). The breakeven point is calculated as the additional cost per seedling ($2.00) divided by the profit margin per cubic meter ($50), giving us the minimum volume gain needed to recover our investment. By comparing the distribution to this threshold, we can directly assess the probability that the tree improvement program will be economically viable.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the uncertainty</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>posterior_predictions <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_gain =</span> total_gain,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain_per_tree =</span> gain_per_tree</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the economic breakeven gain per tree</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional cost per tree = $2.00</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothetical profit per m³ = $50</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Breakeven volume gain = $2.00 / $50 = 0.04 m³ per tree</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>economic_breakeven <span class="ot">&lt;-</span> <span class="fl">2.00</span> <span class="sc">/</span> <span class="dv">50</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(posterior_predictions, <span class="fu">aes</span>(<span class="at">x =</span> gain_per_tree)) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"#1b9e77"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(gain_per_tree), </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> economic_breakeven, </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Posterior Predictive Distribution: Volume Gain per Tree"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Full uncertainty for a future harvest of 1000 trees"</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Volume gain per tree (m³)"</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">sprintf</span>(<span class="st">"Red line = economic breakeven (%.4f m³) | Blue line = expected gain (%.4f m³) | Distribution includes all uncertainty"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                      economic_breakeven, <span class="fu">mean</span>(gain_per_tree))</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key insight: Uncertainty matters for planning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice the <strong>width</strong> of this distribution. While the mean gain per tree is around 0.1076 m³, the 95% credible interval spans from 0.0909 to 0.1234 m³.</p>
<p>This means that even though improved seedlings are expected to produce more volume, there’s substantial uncertainty about <em>how much</em> more. A harvest plan based solely on the mean prediction would miss this variability, potentially leading to:</p>
<ul>
<li><strong>Overcommitted timber contracts</strong> if gains are at the lower end</li>
<li><strong>Missed revenue opportunities</strong> if gains are at the upper end<br>
</li>
<li><strong>Cashflow problems</strong> from unexpected shortfalls</li>
</ul>
<p>By using the <strong>full posterior predictive distribution</strong>, forest managers can: - Set conservative harvest targets (e.g., use the 25th percentile) - Calculate probability of meeting contract volumes - Price timber sales with appropriate risk premiums - Make financially sound long-term investment decisions</p>
<p>This is Bayesian inference at its best: honest quantification of uncertainty that leads to better decisions.</p>
</div>
</div>
<p><br> <strong>Question 3: Economic Payoff Analysis</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Economic parameters (all costs are per seedling)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cost_per_seedling_wild <span class="ot">&lt;-</span> <span class="fl">0.50</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>cost_per_seedling_improved <span class="ot">&lt;-</span> <span class="fl">2.50</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>additional_cost <span class="ot">&lt;-</span> cost_per_seedling_improved <span class="sc">-</span> cost_per_seedling_wild  <span class="co"># $2.00 per tree</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Investment scale: 1 million trees planted</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>trees_planted <span class="ot">&lt;-</span> <span class="fl">1e6</span>  </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>total_investment <span class="ot">&lt;-</span> additional_cost <span class="sc">*</span> trees_planted  <span class="co"># Total additional cost for 1M trees</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothetical profit per m³ (simplified for illustration)</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># In reality, this would be: Product revenue - Stumpage - Harvest costs - Processing</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>profit_per_m3 <span class="ot">&lt;-</span> <span class="dv">50</span>  <span class="co"># dollars per cubic meter</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate economic return for each posterior sample</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># volume_gain is per-tree gain (m³), so multiply by trees_planted for total</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>economic_return <span class="ot">&lt;-</span> volume_gain <span class="sc">*</span> profit_per_m3 <span class="sc">*</span> trees_planted  <span class="co"># Total revenue gain for 1M trees</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>net_benefit <span class="ot">&lt;-</span> economic_return <span class="sc">-</span> total_investment                <span class="co"># Net benefit for 1M trees</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>roi <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> net_benefit <span class="sc">/</span> total_investment                      <span class="co"># ROI as percentage</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize economic outcomes (all values now represent the full 1M tree investment)</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Total investment"</span>,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Expected additional revenue"</span>,</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Expected net benefit"</span>,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Expected ROI"</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"95% CI for net benefit"</span>,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Probability of positive ROI"</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"$%.2f million"</span>, total_investment <span class="sc">/</span> <span class="fl">1e6</span>),</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"$%.2f million"</span>, <span class="fu">mean</span>(economic_return) <span class="sc">/</span> <span class="fl">1e6</span>),</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"$%.2f million"</span>, <span class="fu">mean</span>(net_benefit) <span class="sc">/</span> <span class="fl">1e6</span>),</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, <span class="fu">mean</span>(roi)),</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"[$%.2f, $%.2f] million"</span>, </span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>            <span class="fu">quantile</span>(net_benefit, <span class="fl">0.025</span>) <span class="sc">/</span> <span class="fl">1e6</span>, </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">quantile</span>(net_benefit, <span class="fl">0.975</span>) <span class="sc">/</span> <span class="fl">1e6</span>),</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, <span class="fu">mean</span>(net_benefit <span class="sc">&gt;</span> <span class="dv">0</span>))</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Economic analysis: Tree improvement investment (simplified model)"</span>,</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Economic analysis: Tree improvement investment (simplified model)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Total investment</td>
<td style="text-align: left;">$2.00 million</td>
</tr>
<tr class="even">
<td style="text-align: left;">Expected additional revenue</td>
<td style="text-align: left;">$5.25 million</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Expected net benefit</td>
<td style="text-align: left;">$3.25 million</td>
</tr>
<tr class="even">
<td style="text-align: left;">Expected ROI</td>
<td style="text-align: left;">162.6%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI for net benefit</td>
<td style="text-align: left;">[$-6.09, $12.54] million</td>
</tr>
<tr class="even">
<td style="text-align: left;">Probability of positive ROI</td>
<td style="text-align: left;">0.755</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="visualizing-the-economic-decision" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-economic-decision">Visualizing the Economic Decision</h3>
<p>The plots below provide a complete visualization of the investment decision by showing the full distribution of possible economic outcomes. The upper panel displays the net benefit distribution (revenue minus costs), measured in millions of dollars. The red vertical line marks the breakeven point (zero net benefit), while the blue line shows the expected value. The distribution’s spread reveals the range of possible outcomes given all uncertainties in our model.</p>
<p>The lower panel shows the return on investment (ROI) as a percentage of the $2 million investment. Together, these visualizations answer the key business question: <strong>What’s the probability this investment pays off, and by how much?</strong> Notice that while both distributions center well above breakeven (suggesting the investment is likely profitable), there remains meaningful probability mass on both sides of zero – reflecting honest uncertainty about whether the program will succeed.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe for plotting</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>economic_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">volume_gain =</span> <span class="fu">as.vector</span>(volume_gain),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">net_benefit =</span> <span class="fu">as.vector</span>(net_benefit),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">roi =</span> <span class="fu">as.vector</span>(roi)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot net benefit distribution</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(economic_df, <span class="fu">aes</span>(<span class="at">x =</span> net_benefit <span class="sc">/</span> <span class="fl">1e6</span>)) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"#1b9e77"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(net_benefit) <span class="sc">/</span> <span class="fl">1e6</span>, </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Posterior Distribution of Net Benefit"</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red line = break-even | Blue line = expected value"</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Net Benefit ($ millions)"</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="fu">sprintf</span>(<span class="st">"P(positive ROI) = %.3f"</span>, <span class="fu">mean</span>(net_benefit <span class="sc">&gt;</span> <span class="dv">0</span>))</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROI distribution</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(economic_df, <span class="fu">aes</span>(<span class="at">x =</span> roi)) <span class="sc">+</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"#7570b3"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(roi), </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Posterior Distribution of ROI"</span>,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Return on $2 million investment"</span>,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ROI (%)"</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpreting these results</strong>: The probability of positive ROI (75.5%) indicates this investment is likely worthwhile. However, the wide distributions remind us that outcomes could range from modest losses to substantial gains. A conservative decision-maker might want to see probability &gt; 90% before proceeding, while a more risk-tolerant organization might accept 70-80% as sufficient. The Bayesian framework makes these risk preferences explicit rather than hiding them in arbitrary assumptions.</p>
</section>
<section id="whats-the-minimum-required-gain" class="level3">
<h3 class="anchored" data-anchor-id="whats-the-minimum-required-gain">What’s the Minimum Required Gain?</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What volume gain do we need to break even?</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>breakeven_gain <span class="ot">&lt;-</span> total_investment <span class="sc">/</span> (profit_per_m3 <span class="sc">*</span> trees_planted)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>breakeven_percent <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> breakeven_gain <span class="sc">/</span> <span class="fu">mean</span>(pred_wild)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability we exceed breakeven</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>prob_exceed_breakeven <span class="ot">&lt;-</span> <span class="fu">mean</span>(volume_gain <span class="sc">&gt;</span> breakeven_gain)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Breakeven volume gain"</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Breakeven percent gain"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P(exceeding breakeven)"</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f m³ per tree"</span>, breakeven_gain),</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, breakeven_percent),</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, prob_exceed_breakeven)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Breakeven analysis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Breakeven analysis</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Breakeven volume gain</td>
<td style="text-align: left;">0.040 m³ per tree</td>
</tr>
<tr class="even">
<td style="text-align: left;">Breakeven percent gain</td>
<td style="text-align: left;">11.4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">P(exceeding breakeven)</td>
<td style="text-align: left;">0.755</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Business decision: Investment NOT recommended
</div>
</div>
<div class="callout-body-container callout-body">
<p>With the estimated volume gains and current profit margins, there is only a <strong>75.5% probability</strong> that the tree improvement investment will be profitable.</p>
<p><strong>This means there’s a 24.5% chance of LOSING money on this investment.</strong></p>
<section id="why-this-is-a-poor-investment" class="level3">
<h3 class="anchored" data-anchor-id="why-this-is-a-poor-investment">Why this is a poor investment:</h3>
<ul>
<li>The expected volume gains are <strong>not sufficient</strong> to offset the $2 million additional cost</li>
<li>The risk is <strong>asymmetric</strong>: small upside potential vs.&nbsp;substantial downside risk</li>
<li>With only a 1-in-3 chance of breaking even, this investment fails basic financial due diligence</li>
</ul>
</section>
<section id="what-would-need-to-change" class="level3">
<h3 class="anchored" data-anchor-id="what-would-need-to-change">What would need to change?</h3>
<p>For this investment to make sense, one or more of the following would need to improve:</p>
<ol type="1">
<li><strong>Larger volume gains</strong>: Breeding program would need to deliver &gt;20% gains consistently</li>
<li><strong>Higher profit margins</strong>: Product prices would need to increase or costs decrease<br>
</li>
<li><strong>Lower seedling costs</strong>: Improved seed costs would need to decrease</li>
<li><strong>Other benefits not captured</strong>: Improved form, disease resistance, or faster growth to rotation</li>
</ol>
<p>Decision-makers should <strong>reject this investment</strong> unless substantial improvements in these factors can be demonstrated through additional trials or market analysis.</p>
</section>
</div>
</div>
</section>
<section id="sensitivity-to-profit-margins" class="level3">
<h3 class="anchored" data-anchor-id="sensitivity-to-profit-margins">Sensitivity to Profit Margins</h3>
<p>How sensitive is our investment decision to changes in profit margins? Let’s examine scenarios ranging from depressed markets (lower margins) to boom conditions (higher margins):</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore different profit margin scenarios</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>profit_scenarios <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">scenario =</span> <span class="fu">c</span>(<span class="st">"Low (depressed market)"</span>, <span class="st">"Current (baseline)"</span>, <span class="st">"High (favorable market)"</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">profit_per_m3 =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">70</span>)  <span class="co"># dollars per cubic meter</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate ROI for each scenario</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>roi_by_scenario <span class="ot">&lt;-</span> profit_scenarios <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_return =</span> <span class="fu">map_dbl</span>(profit_per_m3, </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">~</span><span class="fu">mean</span>(volume_gain) <span class="sc">*</span> .x <span class="sc">*</span> trees_planted),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">net_benefit =</span> economic_return <span class="sc">-</span> total_investment,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">roi =</span> <span class="dv">100</span> <span class="sc">*</span> net_benefit <span class="sc">/</span> total_investment,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">prob_positive =</span> <span class="fu">map_dbl</span>(profit_per_m3,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                           <span class="sc">~</span><span class="fu">mean</span>(volume_gain <span class="sc">*</span> .x <span class="sc">*</span> trees_planted <span class="sc">&gt;</span> total_investment))</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>roi_by_scenario <span class="sc">%&gt;%</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scenario, profit_per_m3, roi, prob_positive) <span class="sc">%&gt;%</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">1</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"ROI sensitivity to profit margins"</span>,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Market Scenario"</span>, <span class="st">"Profit Margin ($/m³)"</span>, <span class="st">"Expected ROI (%)"</span>, <span class="st">"P(positive ROI)"</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>ROI sensitivity to profit margins</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 26%">
<col style="width: 21%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Market Scenario</th>
<th style="text-align: right;">Profit Margin ($/m³)</th>
<th style="text-align: right;">Expected ROI (%)</th>
<th style="text-align: right;">P(positive ROI)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Low (depressed market)</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">57.6</td>
<td style="text-align: right;">0.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Current (baseline)</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">162.6</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">High (favorable market)</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">267.7</td>
<td style="text-align: right;">0.8</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Even in a depressed market ($30/m³ profit margin), the investment still shows reasonable returns. In favorable markets ($70/m³), returns are substantial. This sensitivity analysis demonstrates that the investment decision is <strong>robust to margin fluctuations</strong> – a critical consideration for long-term forestry investments that span decades and multiple market cycles.</p>
<p>The high probability of positive ROI across all margin scenarios (assuming our volume gain estimates are accurate) provides confidence for decision-making even under market uncertainty.</p>
</div>
</div>
</section>
</section>
<section id="real-world-application-the-alberta-tree-improvement-investment-problem" class="level2">
<h2 class="anchored" data-anchor-id="real-world-application-the-alberta-tree-improvement-investment-problem">Real-World Application: The Alberta Tree Improvement Investment Problem</h2>
<p><strong>How would this analysis work in practice for an Alberta forest company?</strong> The simplified example above illustrates the Bayesian workflow clearly, but real forestry decisions involve additional layers of complexity – particularly around regulatory approval. Does this interest you? Just follow the rabbit down the hole 🐰</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Business Problem 🐰
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Alberta forest companies face a multi-million dollar question: Should we invest in tree improvement programs? The challenge isn’t biological – field trials consistently show 10-25% volume gains from improved seedlings. The challenge is that <strong>government recognizes only a fraction of demonstrated gains for regulatory purposes</strong>.</p>
<p>In Alberta’s Forest Management Agreement (FMA) system, companies lease harvesting rights on Crown land. To access additional timber volume from tree improvement, they need government approval to adjust their Annual Allowable Cut (AAC) – a mechanism called the Allowable Cut Effect (ACE).</p>
<p><strong>The reality:</strong> As of 2016, seven Controlled Parentage Programs (tree improvement programs) existed in Alberta with government-approved height gains averaging 2.3% – far below the 10-25% demonstrated in field trials. Of these seven programs, only three companies found the economics compelling enough to incorporate the gains into their Forest Management Plans.</p>
<p>Why did the other four companies decline? With only 2.3% recognized gains, the return on investment becomes marginal. When you’re investing millions in breeding programs, seed orchards, and improved seedlings at $2.50 each (vs.&nbsp;$0.50 for wild seed), the economics only work if enough factors align favorably: high deployment rates, manageable costs, good survival rates, favorable markets.</p>
<p>From industry’s perspective <span class="citation" data-cites="schreiber2017forest">(<a href="#ref-schreiber2017forest" role="doc-biblioref">Schreiber &amp; Thomas, 2017</a>)</span>: <em>“The low levels of genetic gain and its translation into the desired ACE, the long timelines for TI program development (i.e., decades), and the lack of certainty and risk aversion with Government approvals do not justify the expenses involved.”</em></p>
<section id="why-standard-cost-benefit-analysis-falls-short" class="level3">
<h3 class="anchored" data-anchor-id="why-standard-cost-benefit-analysis-falls-short">Why Standard Cost-Benefit Analysis Falls Short</h3>
<p><span class="citation" data-cites="schreiber2017forest">Schreiber &amp; Thomas (<a href="#ref-schreiber2017forest" role="doc-biblioref">2017</a>)</span> developed an economic model (TIIFA) for Alberta tree improvement programs. Using sensitivity analysis across different scenarios, they showed that investment <strong>can</strong> be profitable even with modest gains – but profitability depends on multiple uncertain factors aligning favorably.</p>
<p><strong>Their key findings:</strong></p>
<ul>
<li><strong>With 2% volume gain per decade</strong> and deployment reaching 15%+, investment is profitable at 8% discount rate</li>
<li><strong>Deployment area matters as much as genetic gain</strong>: Increasing deployment from 5% to 20% per decade has enormous impact</li>
<li><strong>Program costs are manageable</strong>: Even at $5 million per decade, programs can be profitable</li>
<li><strong>Discount rate is critical</strong>: NPV strongly positive at 4%, moderately positive at 8%, barely positive at 12%</li>
</ul>
<p>But their model analyzed scenarios independently. In reality, companies face <strong>compound uncertainty</strong>:</p>
<ul>
<li>Will we achieve 15% deployment rates across our FMA area? (Operational)</li>
<li>Will program costs stay under $5M per decade? (Financial)</li>
<li>Will the 2.3% recognized gains actually translate to field performance? (Biological)</li>
<li>What will stumpage fees and lumber prices be over the 20-year FMP cycle? (Market)</li>
<li>Will climate change affect realization of genetic gains? (Environmental)</li>
</ul>
<p><strong>Their conclusion:</strong> “<em>Investment in TI still remains a profitable enterprise..</em>. <strong>if</strong> <em>the area planted is maximized on which improved seed is deployed.</em>”</p>
<p>That “if” is doing a lot of work. When four out of seven companies look at the same analysis and decide <strong>not</strong> to incorporate gains into their plans, they’re implicitly saying: “<em>We’re not confident enough that the conditions will align favorably.</em>”</p>
<p>Standard economic models give point estimates under <strong>assumed</strong> scenarios. What companies actually need to know: <em>“What’s the probability our investment will be profitable given simultaneous uncertainty across all these factors?”</em></p>
<p><strong>Government faces similar challenges.</strong> Regulators must balance economic benefits (forest industry jobs, community sustainability) against conservation of public forests. When field trials show 10-25% gains but regulators approve only 2.3%, this conservatism reflects genuine uncertainty: Will gains materialize at scale across diverse sites? Will deployment rates be sufficient? A Bayesian framework could help regulators make more transparent, defensible decisions by quantifying: “At 80% confidence, we expect gains between 1.8-2.8%; approving 2.3% AAC increases keeps risk of over-harvest below 10%.” This provides accountable stewardship of public resources while supporting industry investment.</p>
</section>
<section id="the-bayesian-advantage" class="level3">
<h3 class="anchored" data-anchor-id="the-bayesian-advantage">The Bayesian Advantage</h3>
<p>A Bayesian framework naturally handles <strong>compound uncertainty</strong> by treating each uncertain factor as a probability distribution rather than a fixed assumption:</p>
<p><strong>Instead of:</strong> “Assume we achieve 15% deployment”<br>
<strong>Bayesian says:</strong> “Deployment rate ~ Beta(<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>) based on historical rates across our FMA areas”</p>
<p><strong>Instead of:</strong> “Assume costs stay at $3M per decade”<br>
<strong>Bayesian says:</strong> “Program costs ~ LogNormal(<span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma\)</span>) based on past breeding program expenses”</p>
<p><strong>Instead of:</strong> “Assume 2.3% gains translate to field performance”<br>
<strong>Bayesian says:</strong> “Realized gains ~ Normal(0.023, <span class="math inline">\(\sigma\)</span>) accounting for site-to-site variation”</p>
<p>Then propagate <strong>all</strong> these uncertainties simultaneously through the economic model:</p>
<p>A Bayesian framework handles this the same way we analyzed tree height-diameter relationships earlier in this post: treat each uncertain input as a probability distribution, sample from all distributions simultaneously, and propagate uncertainty through the economic calculation. Instead of running the analysis once with fixed assumptions, you run it thousands of times, each time drawing different combinations of deployment rates, costs, gains, and market conditions from their respective distributions.</p>
<p>The result isn’t a single number but a full probability distribution of outcomes. Instead of “Expected NPV = $7.4M,” you get probability statements that directly answer the business question: “There’s a 73% chance of positive returns, a 45% chance NPV exceeds $5M, and an 8% chance of losses over $2M.” This directly answers the business question: “<strong>What’s the probability this investment pays off given everything we’re uncertain about?</strong>”</p>
<p><span class="citation" data-cites="schreiber2017forest">Schreiber &amp; Thomas (<a href="#ref-schreiber2017forest" role="doc-biblioref">2017</a>)</span> key insight makes it even more important: Deployment area matters as much as genetic gain. In Bayesian terms: If you can <strong>control</strong> deployment (reduce its uncertainty), you dramatically improve the probability distribution of returns. A company that commits to 20% deployment with high confidence has much better odds than one hoping for 15% but uncertain about achieving it.</p>
</section>
<section id="why-this-matters" class="level3">
<h3 class="anchored" data-anchor-id="why-this-matters">Why This Matters</h3>
<p>Forest companies face <strong>compound business uncertainty</strong> when evaluating long-term investments:</p>
<p><strong>Operational uncertainties:</strong></p>
<ul>
<li>Can we realistically achieve 15-20% deployment across diverse FMA areas?</li>
<li>Will field crews consistently plant improved stock rather than wild seed?</li>
<li>How do deployment logistics vary by terrain and access?</li>
</ul>
<p><strong>Financial uncertainties:</strong></p>
<ul>
<li>Will breeding program costs stay manageable over decades?</li>
<li>What will improved seedling costs be as production scales?</li>
<li>How sensitive are returns to discount rate assumptions?</li>
</ul>
<p><strong>Biological uncertainties:</strong></p>
<ul>
<li>Will 2.3% recognized gains translate to actual field performance?</li>
<li>How much site-to-site variation should we expect?</li>
<li>Will climate change affect genetic gain realization?</li>
</ul>
<p><strong>Market uncertainties:</strong></p>
<ul>
<li>What will stumpage fees and lumber prices be over 20-year FMP cycles?</li>
<li>How do mill closures or expansions affect our timber allocation?</li>
</ul>
<p>Standard economic models analyze scenarios independently: “If deployment = 15% and costs = $3M and gains = 2.3%, then NPV = $7.4M.”</p>
<p>Bayesian models integrate across all uncertainties simultaneously: “Accounting for realistic uncertainty in deployment (10-25%), costs ($2-6M), gain realization (1.8-2.8%), and markets, there’s a <strong>73% probability of positive NPV</strong> and a <strong>45% probability NPV exceeds $5M</strong>.”</p>
<p><strong>The critical insight:</strong> When only 3 of 7 companies proceed, it suggests the others looked at compound uncertainty and concluded the probability of success was too low. A Bayesian framework makes that reasoning explicit and quantifiable.</p>
<p>Moreover, it identifies <strong>which uncertainties matter most</strong>. If deployment rate is the dominant factor (as <span class="citation" data-cites="schreiber2017forest">Schreiber &amp; Thomas (<a href="#ref-schreiber2017forest" role="doc-biblioref">2017</a>)</span> suggest), companies can focus on operational commitments that reduce deployment uncertainty rather than waiting for higher genetic gains. A company that can guarantee 20% deployment with high confidence faces much better odds than one hoping for 25% genetic gains that regulators may not recognize.</p>
<p>The Bayesian workflow we’ve demonstrated – specify priors, update with data, propagate uncertainty, make probability statements – applies directly to these multi-million dollar, multi-decade investment decisions where numerous uncertainties compound.</p>
<p>The gap between 2.3% recognized gains and 10-25% demonstrated gains creates a difficult business problem: small recognized gains mean economics are marginal, and compound uncertainties make outcomes unpredictable. Only 3 of 7 Alberta programs found the risk-reward balance favorable. <strong>Quantifying probability of success under compound uncertainty</strong> – rather than analyzing scenarios independently – is exactly where Bayesian methods add value for complex, long-term business decisions.</p>
</section>
</div>
</div>
</div>
</section>
</section>
<section id="key-takeaways-from-seed-germination-to-tree-improvement-to-business-decisions" class="level1">
<h1>Key Takeaways: From Seed Germination to Tree Improvement to Business Decisions</h1>
<section id="the-journey-weve-taken" class="level2">
<h2 class="anchored" data-anchor-id="the-journey-weve-taken">The Journey We’ve Taken</h2>
<p>Over this three-post series, we’ve built a complete understanding of statistical inference:</p>
<p><strong>Post 1 (Frequentist Foundations):</strong> We learned that frequentist inference is about procedures with long-run error rates. Confidence intervals describe what happens across hypothetical repetitions. P-values measure compatibility with null models. These tools are powerful when you want known error rates for repeated decisions.</p>
<p><strong>Post 2 (Bayesian Foundations):</strong> We shifted to thinking about parameters as random variables representing our uncertainty. We learned that Bayesian inference naturally handles sequential learning, allows direct probability statements, and makes assumptions explicit through priors. The seed germination example showed these principles in action for a single parameter.</p>
<p><strong>Post 3 (This Post):</strong> We scaled those principles to multiple parameters without changing the fundamental logic. Tree height regression used the same workflow: specify priors, check if they’re sensible, update with data, validate the model, make probabilistic predictions. The tree improvement example showed how this framework naturally handles real business decisions under uncertainty.</p>
</section>
<section id="core-principles-that-carry-forward" class="level2">
<h2 class="anchored" data-anchor-id="core-principles-that-carry-forward">Core Principles That Carry Forward</h2>
<p><strong>1. Prior choice is critical but not mysterious</strong></p>
<ul>
<li>Don’t use flat priors – they allow nonsense</li>
<li>Use weakly informative priors that encode basic domain knowledge</li>
<li>Always conduct prior predictive checks to validate your choices</li>
<li>Your priors are assumptions made explicit, not a source of bias</li>
</ul>
<p><strong>2. Probability statements answer real questions</strong></p>
<ul>
<li>“P(β &gt; 0) = 0.98” directly answers “Is the effect positive?”</li>
<li>“P(ROI &gt; 0) = 0.85” directly answers “Will this investment pay off?”</li>
<li>No need to translate between p-values and practical meaning</li>
</ul>
<p><strong>3. Uncertainty propagates through all calculations</strong></p>
<ul>
<li>From parameter posteriors → to predictions → to economic outcomes</li>
<li>This prevents false precision and enables realistic planning</li>
<li>Point estimates hide critical information that full distributions reveal</li>
</ul>
<p><strong>4. The Bayesian workflow is consistent</strong></p>
<ol type="1">
<li>Specify priors (encode domain knowledge)</li>
<li>Check priors (prior predictive checks)</li>
<li>Fit model (MCMC sampling)</li>
<li>Check convergence (Rhat, ESS, trace plots)</li>
<li>Validate model (posterior predictive checks)</li>
<li>Make inferences (probability statements)</li>
<li>Make predictions (full uncertainty)</li>
</ol>
<p><strong>5. Model checking is essential</strong></p>
<ul>
<li>Prior predictive checks prevent nonsense inputs</li>
<li>Posterior predictive checks catch model failures</li>
<li>Diagnostic plots reveal computational problems</li>
<li>Bad models give unreliable answers – always validate</li>
</ul>
</section>
<section id="what-changes-and-what-doesnt" class="level2">
<h2 class="anchored" data-anchor-id="what-changes-and-what-doesnt">What Changes and What Doesn’t</h2>
<p><strong>From 1 parameter to many:</strong></p>
<ul>
<li>✓ Same conceptual framework</li>
<li>✓ Same workflow steps</li>
<li>✓ Same interpretation of credible intervals</li>
<li>✗ More complex prior specification (but same principles)</li>
<li>✗ More computationally demanding (but MCMC handles it)</li>
<li>✗ More difficult visualization (but 2D plots of key relationships work)</li>
</ul>
<p><strong>From simple models to complex ones:</strong></p>
<ul>
<li>The principles in this series extend to hierarchical models, time series, spatial statistics, and more</li>
<li>Complexity grows in implementation, not in conceptual foundation</li>
<li>If you understand updating beliefs about germination rates, you understand Bayesian inference</li>
</ul>
</section>
<section id="practical-wisdom" class="level2">
<h2 class="anchored" data-anchor-id="practical-wisdom">Practical Wisdom</h2>
<p><strong>When Bayesian methods shine:</strong></p>
<ul>
<li>Making sequential decisions (examine data as it arrives)</li>
<li>Quantifying probability of specific outcomes (P(effect &gt; threshold))</li>
<li>Incorporating prior knowledge from previous studies</li>
<li>Communicating uncertainty to non-statisticians</li>
<li>Small sample sizes where prior information helps</li>
</ul>
<p><strong>When to be cautious:</strong></p>
<ul>
<li>Prior specification requires thought – no autopilot</li>
<li>Computational demands can be substantial</li>
<li>Different analysts with different priors may disagree (but so will frequentist analysts with different analysis choices)</li>
<li>Skeptical audiences may question prior choices (though the same audiences accept arbitrary <span class="math inline">\(\alpha\)</span>-levels)</li>
</ul>
<p><strong>The bottom line:</strong></p>
<p>Both frequentist and Bayesian frameworks are legitimate approaches to statistical inference. They answer different questions and suit different contexts. The frequentist approach in Post 1 remains widely used, well-understood, and appropriate for many scientific questions. The Bayesian approach offers advantages for decision-making under uncertainty, sequential learning, and direct quantification of what we want to know.</p>
<p>The shift from thinking about procedures to thinking about beliefs is the essence of Bayesian inference. Once you internalize this shift – as we’ve done across three posts from seeds to trees – you can apply the same reasoning to arbitrarily complex models.</p>
<p>The real power isn’t in the fancy mathematics or the MCMC algorithms. It’s in the conceptual clarity of saying “<em>Here’s what I believed before, here’s what I observed, here’s what I believe now, and here’s the probability of what I care about.</em>”</p>
<p><strong>That’s Bayesian inference. You already know how to think this way – we’ve just given you the mathematical tools to do it rigorously.</strong></p>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-galton1886regression" class="csl-entry" role="listitem">
Galton, F. (1886). Regression towards mediocrity in hereditary stature. <em>The Journal of the Anthropological Institute of Great Britain and Ireland</em>, <em>15</em>, 246–263. <a href="https://doi.org/10.2307/2841583">https://doi.org/10.2307/2841583</a>
</div>
<div id="ref-pearson1896mathematical" class="csl-entry" role="listitem">
Pearson, K. (1896). Mathematical contributions to the theory of evolution.—III. Regression, heredity, and panmixia. <em>Philosophical Transactions of the Royal Society of London. Series A</em>, <em>187</em>, 253–318. <a href="https://doi.org/10.1098/rsta.1896.0007">https://doi.org/10.1098/rsta.1896.0007</a>
</div>
<div id="ref-schreiber2017forest" class="csl-entry" role="listitem">
Schreiber, S. G., &amp; Thomas, B. R. (2017). Forest industry investment in tree improvement–a wise business decision or a bottomless pit? Answers from a new tree improvement valuation model for alberta, canada. <em>The Forestry Chronicle</em>, <em>93</em>(1), 38–43. <a href="https://doi.org/10.5558/tfc2017-009">https://doi.org/10.5558/tfc2017-009</a>
</div>
</div>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{schreiber2025,
  author = {Schreiber, Stefan},
  title = {Understanding {Bayesian} {Inference:} {Linear} {Regression}},
  date = {2025-10-27},
  url = {https://envirostats.ca/posts/2025-10-27-understanding-bayesian-inference-linear-regression/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-schreiber2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Schreiber, S. (2025, October 27). <em>Understanding Bayesian Inference:
Linear Regression</em>. <a href="https://envirostats.ca/posts/2025-10-27-understanding-bayesian-inference-linear-regression/">https://envirostats.ca/posts/2025-10-27-understanding-bayesian-inference-linear-regression/</a>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.envirostats\.ca");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, EnviroStats Solutions Inc.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>